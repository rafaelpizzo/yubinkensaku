!function(e){var t={};function s(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=309)}({309:function(e,t,s){s(310),e.exports=s(311)},310:function(e,t,s){"use strict";s.r(t),s.d(t,"Application",(function(){return n}));var r=s(60);class n{constructor(e=[]){this.t0=performance.now(),this.yubinKensaku=new r.default;var t=performance.now();console.log("Processing took "+(t-this.t0)+" milliseconds.")}}window.Application=new n},311:function(e,t,s){},60:function(e,t,s){"use strict";function r(e){return null==e||""===e}s.r(t),s.d(t,"default",(function(){return n}));class n{constructor(e=[]){var t={_namespace:"__yubin_kensaku__",element:null,selectors:{},settings:{minChars:3,matchChars:7,autosearch:!0,appendRegions:!0,regions:["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"],language:"japanese",showErrors:!0,errorMessages:{notFound:"This is not a valid Postal Code.",failed:"Failed to fetch data."},dataSource:"https://raw.githubusercontent.com/rafaelpizzo/yubinkensaku/master/build/data/"},cachedData:{groups:{}}};for(var s in t.settings=function e(t,s){const r=e=>e&&"object"==typeof e;return r(t)&&r(s)?(Object.keys(s).forEach(n=>{const o=t[n],i=s[n];Array.isArray(o)&&Array.isArray(i)?t[n]=o.concat(i):r(o)&&r(i)?t[n]=e(Object.assign({},o),i):t[n]=i}),t):s}(t.settings,e),t)t.hasOwnProperty(s)&&(this[s]=t[s]);r(this.settings.element)?this.element=document.querySelector("[yubin-kensaku]"):this.element=this.settings.element.nodeType===Node.ELEMENT_NODE?this.settings.element:document.querySelector(this.settings.element),this.init()}init(){this.bindElements()}bindElements(){const e=this;if(this.selectors.inputCode=this.element.querySelector("[yubin-code]"),!r(this.selectors.inputCode)){if(this.settings.autosearch){const t=[16,17,18,20,37,38,39,40];this.selectors.inputCode.addEventListener("keyup",(function(s){t.indexOf(s.keyCode)>0||e.selectors.inputCode.value.length>=e.settings.minChars&&e.getAddress(e.selectors.inputCode.value)})),this.selectors.inputCode.addEventListener("change",(function(t){r(e.selectors.inputCode.value.trim())&&e.processAddress(null)}))}this.settings.showErrors&&(this.selectors.errorDisplay=document.querySelector("[yubin-code-error]"),r(this.selectors.errorDisplay)&&(this.selectors.errorDisplay=document.createElement("div"),this.selectors.errorDisplay.classList.add("yubin-code-error"),this.selectors.inputCode.parentNode.insertBefore(this.selectors.errorDisplay,this.selectors.inputCode.nextSibling))),!r(this.selectors.inputCode.value)&&this.selectors.inputCode.value.length>=this.settings.minChars&&this.getAddress(this.selectors.inputCode.value)}this.selectors.inputTrigger=this.element.querySelector("[yubin-trigger]"),r(this.selectors.inputTrigger)||this.selectors.inputTrigger.addEventListener("click",(function(t){t.preventDefault(),e.getAddress(e.selectors.inputCode.value)})),this.selectors.dataFields=this.element.querySelectorAll("[yubin-field]"),[].forEach.call(this.selectors.dataFields,(function(t){if("region"==t.getAttribute("yubin-field")&&e.settings.appendRegions)for(var s=0,r=e.settings.regions.length;s<r;s++){var n=document.createElement("option");n.setAttribute("value",e.settings.regions[s]),n.innerText=e.settings.regions[s],t.appendChild(n)}}))}fetchData(e){return console.info("Fetching data from groupCode",e),t={method:"GET",route:this.settings.dataSource+e+".json",responseType:"json",complete:function(e,t){},success:function(e,t){return t.response},error:function(e,t){console.error(e,t)}},new Promise((function(e,s){var n={method:"POST",route:"/",responseType:null,data:null,complete:function(e,t){},success:function(e,t){},error:function(e,t){},onprogress:function(){},headers:[]};const o={};for(var i in n)o[i]=t.hasOwnProperty(i)?t[i]:n[i];var a=new XMLHttpRequest;if(a.open(o.method,o.route,!0),!r(o.headers))for(var i in o.headers)o.headers.hasOwnProperty(i)&&a.setRequestHeader(o.headers[i][0],o.headers[i][1]);r(o.responseType)||(a.responseType=o.responseType),a.onload=function(){this.status>=200&&this.status<300?e(o.success(a.statusText,a)):(s({status:this.status,statusText:a.statusText}),o.error(a.statusText,a)),o.complete(a.statusText,a)},a.onerror=function(){s({status:this.status,statusText:a.statusText}),o.error(a.statusText,a)},a.onprogress=function(e){o.onprogress(e)},a.send(o.data)})).then(e=>e).catch(e=>e);var t}async getData(e){const t=this,s=t.getGroupCode(e);return t.cachedData.groups.hasOwnProperty(s)?t.cachedData.groups[s]:t.cachedData.groups[s]=t.fetchData(s)}parseCode(e){var t=e.match(/\d+/g);return!r(t)&&Array.isArray(t)&&(t=t.join("")),t}getGroupCode(e){return(e.substring(0,2)+"0").toString()}getAddress(e){const t=this,s=this.parseCode(e);if(r(s))return!1;this.displayError(null),this.getData(s).then((function(e){e.hasOwnProperty(s)?t.processAddress(e[s]):(t.processAddress(null),s.length>=t.settings.matchChars&&t.displayError(t.settings.errorMessages.notFound,s))})).catch((function(e){t.displayError(t.settings.errorMessages.failed,e)}))}processAddress(e){const t=this;var s={region:null,locality:null,street:null};if(null!=e){var n=e[this.settings.language];for(var o in n)s.hasOwnProperty(o)&&(s[o]=n[o])}r(this.selectors.dataFields)||[].forEach.call(this.selectors.dataFields,(function(e){var r=e.getAttribute("yubin-field");s.hasOwnProperty(r)&&t.assignValue(e,s[r])}))}assignValue(e,t){switch(e.tagName.toLowerCase()){case"select":case"input":case"textarea":e.value=t;break;default:e.innerText=t}}displayError(e,t=null){r(e)||console.error(e,t),this.settings.showErrors&&!r(this.selectors.errorDisplay)&&(this.selectors.errorDisplay.innerText=e)}}}});
//# sourceMappingURL=demo.js.map